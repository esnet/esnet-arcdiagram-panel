define(["@grafana/data","react","@grafana/ui","d3"],((e,t,n,a)=>(()=>{"use strict";var r={389:(e,t,n)=>{n.d(t,{Z:()=>l});var a=n(559),r=n.n(a),o=n(476),i=n.n(o)()(r());i.push([e.id,"::-webkit-input-placeholder { /* WebKit, Blink, Edge */\n  color: grey;\n}\n:-moz-placeholder { /* Mozilla Firefox 4 to 18 */\n color: grey;\n opacity:  1;\n}\n::-moz-placeholder { /* Mozilla Firefox 19+ */\n color: grey;\n opacity:  1;\n}\n:-ms-input-placeholder { /* Internet Explorer 10-11 */\n color: grey;\n}\n::-ms-input-placeholder { /* Microsoft Edge */\n color: grey;\n}\n\ninput::placeholder { /* Most modern browsers support this now. */\n color: #808080;\n}\n\n#zoom-button:hover {\n  transform: translateY(-8px);\n  background-color: grey !important;\n}\n\n#search-field {\n  transition: all 250ms;\n}\n\n#search-field input {\n  transition: all 250ms;\n}\n\n#search-field:hover {\n  transform: translateY(-8px);\n}\n\n#search-field input:hover {\n  background-color: rgb(195, 188, 188) !important;\n}\n\n#canvas {\n  overflow: hidden;\n  transform-origin: -50px -50px;\n  transition: transform 0.5s cubic-bezier(0.22, 0.61, 0.36, 1) 0s;\n}\n\n#scroll-box {\n  overflow: scroll\n}","",{version:3,sources:["webpack://./styles.css"],names:[],mappings:"AAAA,8BAA8B,wBAAwB;EACpD,WAAW;AACb;AACA,oBAAoB,4BAA4B;CAC/C,WAAW;CACX,WAAW;AACZ;AACA,qBAAqB,wBAAwB;CAC5C,WAAW;CACX,WAAW;AACZ;AACA,yBAAyB,4BAA4B;CACpD,WAAW;AACZ;AACA,0BAA0B,mBAAmB;CAC5C,WAAW;AACZ;;AAEA,qBAAqB,2CAA2C;CAC/D,cAAc;AACf;;AAEA;EACE,2BAA2B;EAC3B,iCAAiC;AACnC;;AAEA;EACE,qBAAqB;AACvB;;AAEA;EACE,qBAAqB;AACvB;;AAEA;EACE,2BAA2B;AAC7B;;AAEA;EACE,+CAA+C;AACjD;;AAEA;EACE,gBAAgB;EAChB,6BAA6B;EAC7B,+DAA+D;AACjE;;AAEA;EACE;AACF",sourcesContent:["::-webkit-input-placeholder { /* WebKit, Blink, Edge */\n  color: grey;\n}\n:-moz-placeholder { /* Mozilla Firefox 4 to 18 */\n color: grey;\n opacity:  1;\n}\n::-moz-placeholder { /* Mozilla Firefox 19+ */\n color: grey;\n opacity:  1;\n}\n:-ms-input-placeholder { /* Internet Explorer 10-11 */\n color: grey;\n}\n::-ms-input-placeholder { /* Microsoft Edge */\n color: grey;\n}\n\ninput::placeholder { /* Most modern browsers support this now. */\n color: #808080;\n}\n\n#zoom-button:hover {\n  transform: translateY(-8px);\n  background-color: grey !important;\n}\n\n#search-field {\n  transition: all 250ms;\n}\n\n#search-field input {\n  transition: all 250ms;\n}\n\n#search-field:hover {\n  transform: translateY(-8px);\n}\n\n#search-field input:hover {\n  background-color: rgb(195, 188, 188) !important;\n}\n\n#canvas {\n  overflow: hidden;\n  transform-origin: -50px -50px;\n  transition: transform 0.5s cubic-bezier(0.22, 0.61, 0.36, 1) 0s;\n}\n\n#scroll-box {\n  overflow: scroll\n}"],sourceRoot:""}]);const l=i},476:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",a=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),a&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),a&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,a,r,o){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(a)for(var l=0;l<this.length;l++){var s=this[l][0];null!=s&&(i[s]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);a&&i[d[0]]||(void 0!==o&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=o),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),t.push(d))}},t}},559:e=>{e.exports=function(e){var t=e[1],n=e[3];if(!n)return t;if("function"==typeof btoa){var a=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),o="/*# ".concat(r," */");return[t].concat([o]).join("\n")}return[t].join("\n")}},892:e=>{var t=[];function n(e){for(var n=-1,a=0;a<t.length;a++)if(t[a].identifier===e){n=a;break}return n}function a(e,a){for(var o={},i=[],l=0;l<e.length;l++){var s=e[l],c=a.base?s[0]+a.base:s[0],d=o[c]||0,u="".concat(c," ").concat(d);o[c]=d+1;var p=n(u),f={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==p)t[p].references++,t[p].updater(f);else{var m=r(f,a);a.byIndex=l,t.splice(l,0,{identifier:u,updater:m,references:1})}i.push(u)}return i}function r(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var o=a(e=e||[],r=r||{});return function(e){e=e||[];for(var i=0;i<o.length;i++){var l=n(o[i]);t[l].references--}for(var s=a(e,r),c=0;c<o.length;c++){var d=n(o[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}o=s}}},311:e=>{var t={};e.exports=function(e,n){var a=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(n)}},60:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},192:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},760:e=>{e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var a="";n.supports&&(a+="@supports (".concat(n.supports,") {")),n.media&&(a+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(a+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),a+=n.css,r&&(a+="}"),n.media&&(a+="}"),n.supports&&(a+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(a,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},865:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},305:t=>{t.exports=e},388:e=>{e.exports=n},200:e=>{e.exports=a},650:e=>{e.exports=t}},o={};function i(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={id:e,exports:{}};return r[e](n,n.exports,i),n.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nc=void 0;var l={};return(()=>{i.r(l),i.d(l,{plugin:()=>L});var e=i(305),t=i(650),n=i.n(t),a=i(388),r=i(200);function o(e,t){return t.find((t=>t.id===e)).name}function s({id:e,links:t}){return t.filter((t=>t.source===e)).map((e=>e.target))}function c(e,t,n,a,r){const o=Math.log10(a),i=(n-1)/(Math.log10(r)-o);return(Math.log10(e)-o)*i+t}function d(e,t,n,a,r){return(e-a)/(r-a)*(n-t)+t}function u(e,t){const n=[],a=["#FFD700","#00BFFF","#FF8C00","#FF1493","#7FFF00","#9400D3","#00FFFF","#FF69B4","#32CD32","#FFDAB9"],r=["#7CFC00","#1E90FF","#FFA500","#FFC0CB","#8B008B","#32CD32","#FF00FF","#FF6347","#FFFF00","#FF1493"];for(let o=0;o<e;o++){const e=o%r.length;n.push(t?r[e]:a[e])}return n}function p(e,t,n,a,r,o,i,l){a.strokeWidth=e?"log"===t?c(a.arcWeightValue,r,o,i,l):d(a.arcWeightValue,r,o,i,l):n}function f(e,t){var n;const a=e.getBoundingClientRect().width*(t?1.6:1),r=t?.2:.3,o=Number(null===(n=e.getAttribute("transform"))||void 0===n?void 0:n.split(",")[0].substring(10));if(a>o){const t=a-o;e.innerHTML="..."+e.innerHTML.substring(t*r,e.innerHTML.length)}}function m(e){e.innerHTML=e.getAttribute("name")}function h(e,t,n){var a,r;const o=null===(a=n.nodeRange)||void 0===a?void 0:a.split(",").map(Number)[0],i=null===(r=n.nodeRange)||void 0===r?void 0:r.split(",").map(Number)[1],l=Number(Math.min(...e.map((e=>e.sum)))),s=Number(Math.max(...e.map((e=>e.sum))));e.forEach((e=>{n.radiusFromSource?"log"===n.scale?e.radius=c(e.sum,o,i,l,s):e.radius=d(e.sum,o,i,l,s):e.radius=n.nodeRadius}))}function g(e){let t=Array.from(e,(e=>e.getBoundingClientRect().height)),n=Math.max(...t);return n*=1.6,n}function y(e,t,n){let a=[];return e.forEach((e=>{const r=void 0!==e.state.displayName?e.state.displayName:e.name;e.name!==t&&e.name!==n&&a.push({field:e.name,displayName:r})})),a}var v=i(892),b=i.n(v),A=i(760),C=i.n(A),S=i(311),E=i.n(S),x=i(192),w=i.n(x),F=i(60),k=i.n(F),O=i(865),B=i.n(O),M=i(389),I={};I.styleTagTransform=B(),I.setAttributes=w(),I.insert=E().bind(null,"head"),I.domAPI=C(),I.insertStyleElement=k(),b()(M.Z,I),M.Z&&M.Z.locals&&M.Z.locals;const z={containerStyle:{width:"100%",height:"100%"},labelStyle:{width:"100%",height:"100%","z-index":"10"},buttonStyle:{width:"30px",height:"30px",top:0,position:"absolute"},toolTipStyle:{box:{position:"absolute",left:"",top:"",width:"auto",height:"auto",background:"white",padding:"1em",margin:"1em","max-width":"300px","border-radius":"5px",opacity:.9},text:e=>({color:"black","font-size":`${e}px`,margin:"0","font-weight":"100"}),preface:{"font-weight":"900"}},panelContainerStyle:{height:"100%",width:"100%"},searchFieldStyle:{display:"inline-block",margin:"0em 1em","vertical-align":"middle"},inputStyle:e=>({width:"200px",height:"40px",background:e?"rgb(244 245 245 / 83%)":"hsla(0, 0%, 0%, 1)",color:e?"black":"white",padding:"1em","border-radius":"30px"}),toolBarStyle:{top:"10px",right:0,position:"absolute"},zoomButtonWrapper:{margin:"0em 1em","vertical-align":"middle",display:"inline-block"},zoomButtonStyle(e,t){let n,a="30px",r="5px";return n={display:"inline-block","background-color":e?"rgba(244, 245, 245, 0.83)":"black",border:"1px solid rgba(0, 0, 0, 0.1)",cursor:"pointer",transition:"all 250ms","border-top-left-radius":"0px","border-bottom-left-radius":"0px","border-top-right-radius":"0px","border-bottom-right-radius":"0px","padding-left":r,"padding-right":r},0===t?(n["border-top-left-radius"]=a,n["border-bottom-left-radius"]=a,n["padding-left"]=r):2===t&&(n["border-top-right-radius"]=a,n["border-bottom-right-radius"]=a,n["padding-right"]=r),n},zoomIcon:e=>({height:"40px",width:"40px",padding:"0.3em",filter:e?"invert(0)":"invert(1)",animation:"inAnimation 0.5s ease-in"})};let V={source:"",target:n().createElement("p",null),field:n().createElement("p",null),pos:[0,0]};const N=function(e){let a=e.parsedData.uniqueNodes,i=e.parsedData.links;const l=(0,t.useRef)(null),c=(0,t.useRef)(null),d=(0,t.useRef)(null),u=(0,t.useRef)(null),[p,h]=(0,t.useState)(!1),y=e=>{h(e)};function v(t,r,l,c,d,u){if(void 0===c){V.source=o(l,a);const t=s({id:l,links:i});t.length>1?V.target=t.map((e=>o(e,a))).filter(((e,t,n)=>n.indexOf(e)===t)).map(((t,a)=>n().createElement("p",{style:z.toolTipStyle.text(e.zoom),key:a},t,n().createElement("br",null)))):1===t.length?V.target=o(t[0],a):V.target="",e.graphOptions.isCluster?V.field=n().createElement("p",null,n().createElement("b",{style:z.toolTipStyle.preface},"Cluster: ")," ",a[l].cluster):V.field=n().createElement("p",null,n().createElement("b",{style:z.toolTipStyle.preface},"Weight: "),a[l].sum)}else{V.source=o(l,a),V.target=o(c,a);const t=i.find((e=>e.source===l&&e.target===c));V.field=e.parsedData.fields.map(((a,r)=>n().createElement("p",{key:r},n().createElement("b",{style:z.toolTipStyle.preface},a.displayName,":"),t[`${a.field}Display`].map(((t,a)=>n().createElement("p",{style:z.toolTipStyle.text(e.zoom),key:a},t,n().createElement("br",null)))))))}y(r);const p=document.querySelectorAll(`[data-panelid="${e.panelId}"]`)[0];if(void 0!==p){const e=p.getBoundingClientRect();let n=t[1]-e.top,a=t[0]-e.left;const r=document.querySelectorAll("#tooltip")[0],o=r.getBoundingClientRect();let i="left";a+o.right>e.right&&(i="right",a=e.right-t[0]);let l="top";o.height+t[1]+31.99>e.bottom&&(l="bottom",n=e.bottom-t[1]),"top"===l?r.style.top=`${n}px`:r.style.bottom=`${n}px`,"left"===i?r.style.left=`${a}px`:r.style.right=`${a}px`}}var b,A;return(0,t.useEffect)((()=>{r.selectAll(`[data-panelid="${e.panelId}"] circle, [data-panelid="${e.panelId}"] path, [data-panelid="${e.panelId}"] text`).remove();const t=e.width,n=e.height,o=l.current,u=c.current,p=d.current;r.select(p).selectAll(`[data-panelid="${e.panelId}"] text`).data(a).enter().append("text").attr("x",(e=>a.find((t=>t.id===e.id)).radius>=7?-1.6*a.find((t=>t.id===e.id)).radius:-10)).attr("y",(e=>a.find((t=>t.id===e.id)).radius>=7?.8*a.find((t=>t.id===e.id)).radius:10)).text(((e,t)=>a[t].name)).style("text-anchor","end").attr("fill",(()=>e.isDarkMode?"white":"black")).attr("font-size",e.graphOptions.fontSize).attr("transform",((e,t)=>"translate(0,"+n+")rotate(-45)")).style("margin-right","5px").attr("name",((e,t)=>a[t].name)).attr("id",((e,t)=>t));const h=function(e,t,n){const a=(t-e)/(n-1);return Array.from({length:n},((t,n)=>e+n*a))}(e.graphOptions.marginLeft,t-e.graphOptions.marginRight,a.length),b=document.querySelectorAll(`[data-panelid="${e.panelId}"] text`);let A=g(b);r.selectAll(`[data-panelid="${e.panelId}"] text`).attr("transform",((e,t)=>"translate("+h[t]+","+(n-g(b))+")rotate(-45)")),Array.from(b).forEach((e=>{f(e,!1)})),A=g(b),r.selectAll(`[data-panelid="${e.panelId}"] text`).attr("transform",((e,t)=>"translate("+h[t]+","+(n-A)+")rotate(-45)")),r.select(o).selectAll(`[data-panelid="${e.panelId}"] circle`).data(a).enter().append("circle").attr("cx",((e,t)=>h[t])).attr("cy",n-A).attr("r",(e=>null==e?void 0:e.radius)).style("fill",((e,t)=>a[t].color)).attr("id",((e,t)=>a[t].id)).attr("name",((e,t)=>a[t].name)).attr("radius",((e,t)=>a[t].radius)),r.select(u).selectAll(`[data-panelid="${e.panelId}"] path`).data(i).enter().append("path").attr("d",(function(t,a){const r=h[i[a].source],o=h[i[a].target],l=Math.abs(r-o)/2;let s=1*l;e.graphOptions.hopMode&&i[a].isOverlap&&(s=l*i[a].mapRadiusY);const c=Math.abs(r-o)>Math.PI?1:0;return["M",r,n-A,"A",l,",",s,0,c,",",r<o?1:0,o,",",n-A].join(" ")})).style("fill","none").attr("stroke",(e=>null==e?void 0:e.color)).attr("id",((e,t)=>i[t].id)).attr("stroke-width",(e=>null==e?void 0:e.strokeWidth)).style("opacity",e.graphOptions.arcOpacity).attr("source",((e,t)=>i[t].source)).attr("target",((e,t)=>i[t].target)).attr("sum",((e,t)=>i[t].sum)).attr("displayValue",((e,t)=>i[t].displayValue)).attr("path",((e,t)=>i[t].path));const C=r.selectAll(`[data-panelid="${e.panelId}"] circle`),S=r.selectAll(`[data-panelid="${e.panelId}"] path`),E=r.selectAll(`[data-panelid="${e.panelId}"] text`),x=200,w=0!==e.query.length,F=function(e,t){let n=t.map((({name:e,id:t})=>({name:e,id:t})));return n=n.filter((t=>String(t.name).toLowerCase().includes(e.toLowerCase()))),new Set(n.map((e=>e.id)))}(e.query,a);C.on("mouseover",(function(t){v([t.clientX,t.clientY],!0,Number(t.srcElement.id)),b[t.srcElement.id].setAttribute("name",b[t.srcElement.id].innerHTML);const n=s({id:Number(t.srcElement.id),links:i});f(b[t.srcElement.id],!0),n.forEach((e=>{f(b[e],!0)})),C.style("opacity",(e=>w?F.has(e.id)?1:.1:n.includes(e.id)?1:.1)).transition().attr("r",(e=>w?a[e.id].radius:n.includes(e.id)?2*a[e.id].radius:a[e.id].radius)).duration(x),r.select(this).style("opacity",1).transition().duration(x).attr("r",2*a[t.srcElement.id].radius),S.transition().style("opacity",(n=>w?F.has(n.source)||F.has(n.target)?e.graphOptions.arcOpacity:.1:t.srcElement.id==(null==n?void 0:n.source)||t.srcElement.id==(null==n?void 0:n.target)?e.graphOptions.arcOpacity:.1)).attr("stroke-width",(e=>t.srcElement.id==(null==e?void 0:e.source)||t.srcElement.id==(null==e?void 0:e.target)?2*(null==e?void 0:e.strokeWidth):null==e?void 0:e.strokeWidth)).duration(x),E.transition().duration(x).attr("font-size",(a=>w?a.name===t.srcElement.getAttribute("name")?1.6*e.graphOptions.fontSize:e.graphOptions.fontSize:a.name===t.srcElement.getAttribute("name")||n.includes(a.id)?1.6*e.graphOptions.fontSize:e.graphOptions.fontSize)).style("opacity",(e=>w?e.name===t.srcElement.getAttribute("name")?1:.1:e.name===t.srcElement.getAttribute("name")||n.includes(e.id)?1:.1))})).on("mouseout",(function(t){const n=s({id:Number(t.srcElement.id),links:i});f(b[t.srcElement.id],!1),m(b[t.srcElement.id]),n.forEach((e=>{m(b[e])})),y(!1),C.transition().duration(x).attr("r",(e=>a[e.id].radius)).style("opacity",(e=>w?F.has(e.id)?1:.1:1)),r.select(this).transition().duration(x).attr("r",a[t.srcElement.id].radius),S.transition().duration(x).style("opacity",(t=>w?F.has(t.source)||F.has(t.target)?e.graphOptions.arcOpacity:.1:e.graphOptions.arcOpacity)).attr("stroke-width",(e=>null==e?void 0:e.strokeWidth)),E.transition().duration(x).attr("font-size",e.graphOptions.fontSize).style("opacity",(e=>w?F.has(e.id)?1:.1:1))})),S.on("mouseover",(function(t){v([t.clientX,t.clientY],!0,Number(t.srcElement.getAttribute("source")),Number(t.srcElement.getAttribute("target")),t.srcElement.getAttribute("displayValue"),t.srcElement.id),S.style("opacity",(n=>w?F.has(n.source)||F.has(n.target)?e.graphOptions.arcOpacity:.1:e.graphOptions.hopMode&&Number(t.srcElement.getAttribute("path"))===n.path?e.graphOptions.arcOpacity:.1)).transition().duration(x),r.select(this).transition().style("opacity",e.graphOptions.arcOpacity).duration(x)})).on("mouseout",(function(t){y(!1),S.transition().duration(x).style("opacity",(t=>w?F.has(t.source)||F.has(t.target)?e.graphOptions.arcOpacity:.1:e.graphOptions.arcOpacity)).attr("stroke-width",(e=>null==e?void 0:e.strokeWidth)),r.select(this).transition().style("opacity",(t=>w?F.has(t.source)||F.has(t.target)?e.graphOptions.arcOpacity:.1:e.graphOptions.arcOpacity)).duration(x).attr("stroke-width",(e=>null==e?void 0:e.strokeWidth))})),e.graphOptions.search&&w&&function(e,t,n,a,r,o){let i=t.map((({name:e,id:t})=>({name:e,id:t})));i=i.filter((t=>String(t.name).toLowerCase().includes(e.toLowerCase())));const l=new Set(i.map((e=>e.id)));e&&(n.style("opacity",(e=>l.has(e.id)?1:.1)),a.style("opacity",(e=>l.has(e.source)||l.has(e.target)?o:.1)),r.style("opacity",(e=>l.has(e.id)?1:.1)))}(e.query,a,E,S,C,e.graphOptions.arcOpacity)}),[e.graphOptions,i,e.height,e.width,a]),void 0!==document.querySelectorAll(`[data-panelid="${e.panelId}"] #canvas`)[0]&&(b=document.querySelectorAll(`[data-panelid="${e.panelId}"] #canvas`)[0],A=e.zoomState,b.style.transform=`scale(${A/10})`),n().createElement("div",{style:z.containerStyle},n().createElement("div",{id:"canvas",style:z.containerStyle},n().createElement("svg",{style:z.containerStyle,ref:l},n().createElement("g",{style:z.containerStyle,ref:c}),n().createElement("svg",{style:z.labelStyle,ref:d}))),p&&n().createElement("div",{ref:u,style:z.toolTipStyle.box,id:"tooltip"},n().createElement("p",{style:z.toolTipStyle.text(e.graphOptions.tooltipFontSize)},n().createElement("b",{style:z.toolTipStyle.preface},e.graphOptions.toolTipSource)," "," ",V.source),n().createElement("br",null),n().createElement("div",{style:z.toolTipStyle.text(e.graphOptions.tooltipFontSize)},n().createElement("b",{style:z.toolTipStyle.preface},e.graphOptions.toolTipTarget),V.target),n().createElement("br",null),n().createElement("p",{style:z.toolTipStyle.text(e.graphOptions.tooltipFontSize)}," ",V.field)))};function D(e){return n().createElement("div",{id:"search-field",style:z.searchFieldStyle},n().createElement("input",{placeholder:"Search nodes/edges",style:z.inputStyle(e.isDarkMode),type:"text",onChange:t=>{e.onQuery(t.target.value)}}))}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const W=({value:e,onChange:r,item:o,suffix:i})=>{const l=(0,t.useCallback)((e=>{r(String(e))}),[r]);return n().createElement("div",null,n().createElement(a.RangeSlider,{min:1,max:50,onAfterChange:l,onChange:l,orientation:"horizontal",value:[1,15]}))};function R(e,t,n,a,r,o,i){try{var l=e[o](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(a,r)}function $(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function i(e){R(o,a,r,i,l,"next",e)}function l(e){R(o,a,r,i,l,"throw",e)}i(void 0)}))}}const P=["Appearance"],j=["Data"],q=["Mode"],L=new e.PanelPlugin((({options:e,data:n,width:r,height:o,id:i})=>{const[l,s]=(0,t.useState)(""),[c,d]=(0,t.useState)(10),f=(e,t)=>{(e||10!==c)&&(d(e?c+1:c-1),t&&d(10))};let m=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){T(e,t,n[t])}))}return e}({},e);const g=(0,a.useTheme2)();if(e.isCluster&&n.series[0].fields.length<5)return t.createElement("div",null,"Node clustering requires a 4th group by");if(e.isCluster&&n.series[0].fields.length,e.isCluster&&(""===e.srcCluster||""===e.dstCluster))return t.createElement("div",null,"Choose fields for clustering");const v=n.request.targets[0].bucketAggs;let b;for(let e=0;e<v.length;e++){if("date_histogram"===v[e].type){b=!0;break}b=!1}if(b)return t.createElement("div",null,"Datasource type Date Histogram not supported");if(!e.hopMode){const a=e.src?n.series[0].fields.find((t=>t.name===e.src)).name:n.series[0].fields[0].name,r=e.dest?n.series[0].fields.find((t=>t.name===e.dest)).name:n.series[0].fields[1].name;if(a===r)return t.createElement("div",null,"Source equals target");if(e.isCluster&&(e.srcCluster===a||e.srcCluster===r||e.dstCluster===a||e.dstCluster===r))return t.createElement("div",null,"Fields for clustering can not be links source or target fields")}let A={uniqueNodes:[],links:[]};try{A=e.hopMode?function(e,t,n){var a,r,o;const i=e.series[0].fields,l=i[0].values,s=t.arcWeightSource?i.find((e=>e.name===t.arcWeightSource)).name:i[i.length-1].name,c=null===(a=i.find((e=>e.name===s)))||void 0===a?void 0:a.values,d=y(i),f="space"===t.delimiter?" ":t.delimiter;let m=Array.from([...new Set(i[0].values.join(f).split(f))]).map(((e,n)=>({id:n,name:e,sum:1,radius:5,color:t.nodeColor})));const g=u(l.length,n.isDark);let v=[];l.forEach(((e,t)=>{const n=String(e).split(" ");for(let e=0;e<n.length;e++){var a,r;const o=null===(a=m.find((t=>t.name===n[e])))||void 0===a?void 0:a.id,l=null===(r=m.find((t=>t.name===n[e+1])))||void 0===r?void 0:r.id,s=v.some((e=>e.source===o&&e.target===l));if(void 0!==l){const e={id:0,source:o,target:l,path:t,arcWeightValue:c[t],strokeWidth:1,color:g[t],displayValue:`${i[i.length-1].display(i[i.length-1].values[t]).text}${void 0!==i[i.length-1].display(i[i.length-1].values[t]).suffix?i[i.length-1].display(i[i.length-1].values[t]).suffix:""}`,isOverlap:s,mapRadiusY:0};d.forEach((n=>{var a,r;Object.assign(e,{[n.field]:[]}),e[n.field].push(null===(a=i.find((e=>e.name===n.field)))||void 0===a?void 0:a.values[t]);const o=i.find((e=>e.name===n.field)).display(null===(r=i.find((e=>e.name===n.field)))||void 0===r?void 0:r.values[t]),l=void 0===o.suffix?"":o.suffix;Object.assign(e,{[`${n.field}Display`]:[`${o.text} ${l}`]})})),v.push(e)}}})),v.forEach(((e,t)=>{e.id=t}));const b=v.filter((e=>e.isOverlap)),A=[],C=[];for(let e=0;e<b.length;e++){const t=b[e],n=[t];if(!C.includes(t)){for(let a=e+1;a<b.length;a++){const e=b[a];t.source===e.source&&t.target===e.target&&(n.push(e),C.push(e))}A.push(n)}}for(let e=0;e<A.length;e++){const n=A[e];let a=t.yRad;for(let e=0;e<n.length;e++)n[e].mapRadiusY=a,a+=t.yRad-1}const S=null===(r=t.arcRange)||void 0===r?void 0:r.split(",").map(Number)[0],E=null===(o=t.arcRange)||void 0===o?void 0:o.split(",").map(Number)[1],x=Number(Math.min(...v.map((e=>e.arcWeightValue)))),w=Number(Math.max(...v.map((e=>e.arcWeightValue))));for(let e=0;e<v.length;e++)p(t.arcFromSource,t.scale,t.arcThickness,v[e],S,E,x,w);return h(m,0,t),{uniqueNodes:m,links:v,fields:d}}(n,m,g):function(e,t,n){var a,r,o,i,l;const s=e.series[0].fields,c=t.src?s.find((e=>e.name===t.src)).name:s[0].name,d=t.dest?s.find((e=>e.name===t.dest)).name:s[1].name,f=null===(a=s.find((e=>e.name===c)))||void 0===a?void 0:a.values,m=null===(r=s.find((e=>e.name===d)))||void 0===r?void 0:r.values,g=t.arcWeightSource?s.find((e=>e.name===t.arcWeightSource)).name:s[s.length-1].name,v=null===(o=s.find((e=>e.name===g)))||void 0===o?void 0:o.values,b=y(s,c,d),A={nodeColor:n.visualization.getColorByName(t.nodeColor)},C=Array.from([...new Set([...f,...m])]).map(((e,t)=>({id:t,name:e,sum:0,radius:0,cluster:"",color:A.nodeColor})));let S=f.map((e=>{const t=C.find((t=>t.name===e));return t?t.id:null})),E=m.map((e=>{const t=C.find((t=>t.name===e));return t?t.id:null})),x=S.map(((e,n)=>{var a;return{srcName:f[n],dstName:m[n],source:e,target:E[n],arcWeightValue:v[n],strokeWidth:0,color:s[s.length-1].display(s[s.length-1].values[n]).color,[t.colorConfigField]:null===(a=s.find((e=>e.name===t.colorConfigField)))||void 0===a?void 0:a.values[n]}}));if(x.forEach(((e,t)=>{b.forEach((n=>{var a,r;Object.assign(e,{[n.field]:[]}),e[n.field].push(null===(a=s.find((e=>e.name===n.field)))||void 0===a?void 0:a.values[t]);const o=s.find((e=>e.name===n.field)).display(null===(r=s.find((e=>e.name===n.field)))||void 0===r?void 0:r.values[t]),i=void 0===o.suffix?"":o.suffix;Object.assign(e,{[`${n.field}Display`]:[`${o.text} ${i}`]})}))})),t.isCluster&&function(e,t,n,a,r){var o,i;const l=null===(o=r.find((e=>e.name===n.srcCluster)))||void 0===o?void 0:o.values.buffer,s=null===(i=r.find((e=>e.name===n.dstCluster)))||void 0===i?void 0:i.values.buffer;for(let a=0;a<t.length;a++)Object.assign(t[a],{[n.srcCluster]:[]}),t[a][n.srcCluster].push(l[a]),Object.assign(t[a],{[n.dstCluster]:[]}),t[a][n.dstCluster].push(s[a]),e[t[a].source].cluster=t[a][n.srcCluster][0],e[t[a].target].cluster=t[a][n.dstCluster][0];e.sort(((e,t)=>e.cluster<t.cluster?-1:e.cluster>t.cluster?1:0));for(let t=0;t<e.length;t++)e[t].id=t;let c=[];c=[...new Set(e.map((e=>e.cluster)))].map((e=>({name:e,color:""})));const d=u(c.length,a.isDark);c.forEach(((e,t)=>{e.color=d[t]})),e.forEach((e=>{e.color=c.find((t=>t.name===e.cluster)).color})),t.forEach((t=>{t.source=e.find((e=>e.name===t.srcName)).id,t.target=e.find((e=>e.name===t.dstName)).id}))}(C,x,t,n,s),s.length>3){const e=x.reduce(((e,n,a)=>{const r=e.find((e=>e.source===n.source&&e.target===n.target));if(r)b.forEach((e=>{if(void 0!==s.find((t=>t.name===e.field)).state.range){let t=r[e.field][0]+n[e.field][0];r[e.field]=[t];const a=s.find((t=>t.name===e.field)).display(t);r[`${e.field}Display`]=[`${a.text} ${a.suffix}`]}else r[e.field].includes(n[e.field])||n[e.field].forEach((t=>{r[e.field].push(t)})),r[`${e.field}Display`]=r[e.field]}));else{const a={srcName:n.srcName,dstName:n.dstName,source:n.source,target:n.target,arcWeightValue:n.arcWeightValue,displayValue:n.displayValue,strokeWidth:0,color:n.color,[t.colorConfigField]:n[t.colorConfigField]};b.forEach((e=>{Object.assign(a,{[e.field]:[]}),a[e.field]=n[e.field];const t=s.find((t=>t.name===e.field)).display(n[e.field][0]),r=void 0===t.suffix?"":t.suffix;void 0!==s.find((t=>t.name===e.field)).state.range?Object.assign(a,{[`${e.field}Display`]:[`${t.text} ${r}`]}):Object.assign(a,{[`${e.field}Display`]:n[e.field]})})),e.push(a)}return e}),[]);x=e}!function(e,t){const n={};e.forEach((e=>{const{source:t,target:a,arcWeightValue:r}=e;n[t]?n[t]+=r:n[t]=r,n[a]?n[a]+=r:n[a]=r})),t.map((function(e,t){e.sum=n[t]}))}(x,C),h(C,0,t);let w=[];if("default"!==t.linkColorConfig&&t.colorConfigField){w=[...new Set(x.map((e=>Array.isArray(e[t.colorConfigField])?e[t.colorConfigField][e[t.colorConfigField].length-1]:e[t.colorConfigField])))].map((e=>({[t.colorConfigField]:e,color:""})));const e=u(w.length,n.isDark);w.forEach(((t,n)=>{t.color=e[n]}))}const F=null===(i=t.arcRange)||void 0===i?void 0:i.split(",").map(Number)[0],k=null===(l=t.arcRange)||void 0===l?void 0:l.split(",").map(Number)[1],O=Number(Math.min(...x.map((e=>e.arcWeightValue)))),B=Number(Math.max(...x.map((e=>e.arcWeightValue))));return x.forEach(((e,n)=>{if(p(t.arcFromSource,t.scale,t.arcThickness,e,F,k,O,B),"field"===t.linkColorConfig&&w){const n=Array.isArray(e[t.colorConfigField])?e[t.colorConfigField][e[t.colorConfigField].length-1]:e[t.colorConfigField];e.color=w.find((e=>e[t.colorConfigField]===n)).color}})),{uniqueNodes:C,links:x,hexColors:A,fields:b}}(n,m,g)}catch(e){console.error("parsing error: ",e)}if(function(e,t,n,a){let r=0;if(0!==t.length){let a=0,o=null;for(const e of t){const t=Math.abs(e.target-e.source);t>a&&(a=t,o=e)}r=(o.target-o.source)*((n-50-50)/(e.length-1))/2}return r+3.77*e.reduce(((e,t)=>t.name.length>e.name.length?t:e)).name.length*1.6*(a/10)+31.99}(A.uniqueNodes,A.links,r,e.fontSize)>o)return t.createElement("div",null,"Increase panels height to fit diagram");const C=g.colors.text.primary;return t.createElement("div",{id:"scroll-box",style:z.panelContainerStyle},t.createElement(N,{textColor:C,parsedData:A,graphOptions:m,width:r,height:o,query:l,isDarkMode:g.isDark,panelId:i,zoomState:c}),t.createElement("div",{style:z.toolBarStyle},e.search&&t.createElement(D,{onQuery:s,nodeList:A.uniqueNodes,isDarkMode:g.isDark}),e.zoom&&t.createElement("div",{style:z.zoomButtonWrapper},t.createElement("button",{id:"zoom-button",style:z.zoomButtonStyle(g.isDark,0),onClick:()=>f(!1)},t.createElement("img",{style:z.zoomIcon(g.isDark),src:"public/plugins/esnet-arcdiagram-panel/img/area_zoom_out.svg",alt:""})),t.createElement("button",{id:"zoom-button",style:z.zoomButtonStyle(g.isDark,1),onClick:()=>f(!0)},t.createElement("img",{style:z.zoomIcon(g.isDark),src:"public/plugins/esnet-arcdiagram-panel/img/area_zoom_in.svg",alt:""})),t.createElement("button",{id:"zoom-button",style:z.zoomButtonStyle(g.isDark,2),onClick:()=>f(!0,!0)},t.createElement("img",{style:z.zoomIcon(g.isDark),src:"public/plugins/esnet-arcdiagram-panel/img/reset_icon.svg",alt:""})))))})).setPanelOptions((t=>{return t.addBooleanSwitch({path:"hopMode",name:"Visualize AS path",defaultValue:!1,category:q,showIf:e=>!e.isCluster}).addSelect({path:"delimiter",name:"String delimiter",description:"Character to seperate nodes by",defaultValue:"Space",category:q,settings:{allowCustomValue:!1,options:[{label:"Space",value:"space"},{label:",",value:","},{label:";",value:";"},{label:":",value:":"}]},showIf:e=>e.hopMode}).addBooleanSwitch({path:"arcFromSource",name:"Arc thickness from source",defaultValue:!1,category:P}).addBooleanSwitch({path:"radiusFromSource",name:"Node radius from source",defaultValue:!1,category:P,showIf:e=>!e.hopMode}).addSelect({path:"arcWeightSource",name:"Weight field",description:"Select a field for the arc and node weight (has to be a metric):",category:P,settings:{allowCustomValue:!1,options:[],getOptions:(n=$((function*(e){const t=[];if(e&&e.data)for(const n of e.data)for(const e of n.fields){const n=e.name;t.push({value:n,label:n})}return Promise.resolve(t)})),function(e){return n.apply(this,arguments)})},showIf:e=>e.arcFromSource||e.radiusFromSource}).addSliderInput({path:"arcThickness",name:"Arc thickness",defaultValue:1,settings:{min:1,max:15,step:1},showIf:e=>!e.arcFromSource,category:P}).addSliderInput({path:"arcOpacity",name:"Arc opacity",defaultValue:1,settings:{min:.6,max:1,step:.1},category:P}).addSliderInput({path:"nodeRadius",name:"Node radius",defaultValue:5,settings:{min:5,max:15,step:1},showIf:e=>!e.radiusFromSource,category:P}).addSelect({path:"linkColorConfig",name:"Link color",description:'Select configuration for the link color ("By Field" will overwrite threshold)',defaultValue:"default",category:P,settings:{allowCustomValue:!1,options:[{label:"Default",value:"default"},{label:"By field",value:"field"}]},showIf:e=>!e.hopMode}).addSelect({path:"colorConfigField",name:"Field",description:"Select a field to base the link color on",category:P,settings:{allowCustomValue:!1,options:[],getOptions:function(){var t=$((function*(t){const n=[];if(t&&t.data)for(const a of t.data)for(const r of a.fields){const o=(0,e.getFieldDisplayName)(r,a,t.data),i=o;n.push({value:i,label:o})}return Promise.resolve(n)}));return function(e){return t.apply(this,arguments)}}()},showIf:e=>"default"!==e.linkColorConfig}).addColorPicker({path:"nodeColor",name:"Node Color",defaultValue:"blue",category:P,showIf:e=>!e.isCluster}).addSliderInput({path:"fontSize",name:"Font size",defaultValue:10,settings:{min:5,max:20,step:1},category:P}).addSliderInput({path:"tooltipFontSize",name:"Tooltip font size",defaultValue:8,settings:{min:8,max:20,step:1},category:P}).addSliderInput({path:"yRad",name:"Margin between overlapping links",defaultValue:1.3,settings:{min:1,max:2,step:.1},showIf:e=>e.hopMode,category:P}).addSliderInput({path:"marginLeft",name:"Margin from left border",defaultValue:50,settings:{min:0,max:200,step:1},category:P}).addSliderInput({path:"marginRight",name:"Margin from right border",defaultValue:50,settings:{min:0,max:200,step:1},category:P}).addBooleanSwitch({path:"search",name:"Show search bar",defaultValue:!1,category:P}).addBooleanSwitch({path:"zoom",name:"Show zoom button",defaultValue:!1,category:P}).addTextInput({path:"toolTipSource",name:"Tooltip source",category:P,defaultValue:"From: ",description:"Text to be displayed infront of target node."}).addTextInput({path:"toolTipTarget",name:"Tooltip target",category:P,defaultValue:"To: ",description:"Text to be displayed infront of source node."}).addSelect({path:"scale",name:"Scaling",defaultValue:"lin",description:"Select the scaling of the diagram",settings:{allowCustomValue:!1,options:[{label:"Linear",value:"lin"},{label:"Logarithmic",value:"log"}]},showIf:e=>e.radiusFromSource||e.arcFromSource,category:j}).addCustomEditor({id:"setRange",path:"arcRange",editor:W,name:"Range for weighted links",description:"Range which the arc thickness is being mapped to",category:j,defaultValue:"1,15",showIf:e=>e.arcFromSource}).addCustomEditor({id:"setRange",path:"nodeRange",editor:W,name:"Range for weighted nodes",description:"Range which the node radius is being mapped to",category:j,defaultValue:"1,15",showIf:e=>e.radiusFromSource}).addBooleanSwitch({path:"isCluster",name:"Activate node clustering",defaultValue:!1,category:j}).addSelect({path:"srcCluster",name:"Source cluster",description:"Select the field to cluster the source by:",category:j,defaultValue:"",settings:{allowCustomValue:!1,options:[],getOptions:function(){var t=$((function*(t){const n=[];if(t&&t.data)for(const a of t.data)for(const r of a.fields){const o=(0,e.getFieldDisplayName)(r,a,t.data),i=o;n.push({value:i,label:o})}return Promise.resolve(n)}));return function(e){return t.apply(this,arguments)}}()},showIf:e=>e.isCluster}).addSelect({path:"dstCluster",name:"Destination cluster",description:"Select the field to cluster the target by:",category:j,defaultValue:"",settings:{allowCustomValue:!1,options:[],getOptions:function(){var t=$((function*(t){const n=[];if(t&&t.data)for(const a of t.data)for(const r of a.fields){const o=(0,e.getFieldDisplayName)(r,a,t.data),i=o;n.push({value:i,label:o})}return Promise.resolve(n)}));return function(e){return t.apply(this,arguments)}}()},showIf:e=>e.isCluster}).addSelect({path:"pathField",name:"Path",description:"Select the field to use as traceroute:",category:j,defaultValue:"",settings:{allowCustomValue:!1,options:[],getOptions:function(){var t=$((function*(t){const n=[];if(t&&t.data)for(const a of t.data)for(const r of a.fields){const o=(0,e.getFieldDisplayName)(r,a,t.data),i=o;n.push({value:i,label:o})}return Promise.resolve(n)}));return function(e){return t.apply(this,arguments)}}()},showIf:e=>e.hopMode}).addSelect({path:"src",name:"Source",description:"Select the field to use as source:",category:j,settings:{allowCustomValue:!1,options:[],getOptions:function(){var t=$((function*(t){const n=[];if(t&&t.data)for(const a of t.data)for(const r of a.fields){const o=(0,e.getFieldDisplayName)(r,a,t.data),i=o;n.push({value:i,label:o})}return Promise.resolve(n)}));return function(e){return t.apply(this,arguments)}}()},showIf:e=>!e.hopMode}).addSelect({path:"dest",name:"Destination",description:"Select the field to use as target:",category:j,defaultValue:"",settings:{allowCustomValue:!1,options:[],getOptions:function(){var t=$((function*(t){const n=[];if(t&&t.data)for(const a of t.data)for(const r of a.fields){const o=(0,e.getFieldDisplayName)(r,a,t.data),i=o;n.push({value:i,label:o})}return Promise.resolve(n)}));return function(e){return t.apply(this,arguments)}}()},showIf:e=>!e.hopMode});var n})).useFieldConfig({disableStandardOptions:[e.FieldConfigProperty.NoValue,e.FieldConfigProperty.Max,e.FieldConfigProperty.Min],standardOptions:{[e.FieldConfigProperty.Color]:{settings:{byValueSupport:!0,bySeriesSupport:!0,preferThresholdsMode:!0}}}})})(),l})()));
//# sourceMappingURL=module.js.map